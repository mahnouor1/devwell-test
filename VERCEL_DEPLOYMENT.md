# Vercel Deployment Guide

This guide will help you deploy the DevWell Dashboard to Vercel.

## Prerequisites

1. A GitHub account
2. A Vercel account (sign up at [vercel.com](https://vercel.com))
3. GitHub OAuth App configured

## Step 1: Update GitHub OAuth App

1. Go to GitHub Settings > Developer settings > OAuth Apps
2. Edit your OAuth App
3. Update the **Authorization callback URL** to:
   - For production: `https://your-app-name.vercel.app/api/auth/github/callback`
   - You'll get the exact URL after deploying to Vercel

## Step 2: Deploy to Vercel

### Option A: Deploy via Vercel Dashboard

1. Go to [vercel.com](https://vercel.com) and sign in
2. Click "Add New Project"
3. Import your GitHub repository (`mahnouor1/devwell-test`)
4. Configure the project:
   - **Framework Preset**: Vite
   - **Root Directory**: `./` (root)
   - **Build Command**: `npm run build`
   - **Output Directory**: `dist`
   - **Install Command**: `npm install`

### Option B: Deploy via Vercel CLI

```bash
npm i -g vercel
vercel
```

## Step 3: Set Environment Variables

In your Vercel project dashboard, go to **Settings > Environment Variables** and add:

### Required Variables

```
GITHUB_CLIENT_ID=your_github_client_id
GITHUB_CLIENT_SECRET=your_github_client_secret
GITHUB_REDIRECT_URL=https://your-app-name.vercel.app/api/auth/github/callback
JWT_SECRET=your_secure_random_string
FRONTEND_URL=https://your-app-name.vercel.app
```

### Optional Variables

```
PORT=3000
NODE_ENV=production
```

**Important**: 
- Replace `your-app-name.vercel.app` with your actual Vercel deployment URL
- Use a strong, random string for `JWT_SECRET` (at least 32 characters)
- After setting variables, **redeploy** your application

## Step 4: Update GitHub OAuth Callback URL

After deployment, Vercel will give you a URL like:
- `https://devwell-test.vercel.app` (production)
- `https://devwell-test-abc123.vercel.app` (preview)

1. Copy your production URL
2. Go to GitHub OAuth App settings
3. Update **Authorization callback URL** to:
   ```
   https://your-app-name.vercel.app/api/auth/github/callback
   ```
4. Update `GITHUB_REDIRECT_URL` in Vercel environment variables to match

## Step 5: Redeploy

After updating environment variables and GitHub OAuth settings:

1. Go to Vercel dashboard
2. Click on your project
3. Go to **Deployments** tab
4. Click the **⋯** menu on the latest deployment
5. Click **Redeploy**

## Troubleshooting

### 404 Error

If you see a 404 error:
- ✅ Check that `vercel.json` exists in the root directory
- ✅ Verify `api/index.js` exists
- ✅ Ensure environment variables are set correctly
- ✅ Check Vercel build logs for errors

### OAuth Not Working

If GitHub OAuth fails:
- ✅ Verify `GITHUB_REDIRECT_URL` matches your Vercel URL exactly
- ✅ Check that GitHub OAuth App callback URL matches
- ✅ Ensure all environment variables are set in Vercel
- ✅ Check browser console and Vercel function logs

### Cookies Not Working

If cookies aren't being set:
- ✅ Vercel automatically handles cookies for serverless functions
- ✅ Check that `secure: true` is set for HTTPS (Vercel handles this automatically)
- ✅ Verify `sameSite: 'lax'` is set

## Project Structure for Vercel

```
Devbeing_project/
├── api/
│   └── index.js          # Vercel serverless function (Express app)
├── server/               # Backend code (imported by api/index.js)
├── src/                  # Frontend React app
├── dist/                 # Build output (generated by `npm run build`)
├── vercel.json           # Vercel configuration
└── package.json
```

## Environment Variables Reference

| Variable | Required | Description |
|----------|----------|-------------|
| `GITHUB_CLIENT_ID` | Yes | GitHub OAuth Client ID |
| `GITHUB_CLIENT_SECRET` | Yes | GitHub OAuth Client Secret |
| `GITHUB_REDIRECT_URL` | Yes | Must match: `https://your-app.vercel.app/api/auth/github/callback` |
| `JWT_SECRET` | Yes | Secret for JWT token signing (32+ characters) |
| `FRONTEND_URL` | Yes | Your Vercel deployment URL: `https://your-app.vercel.app` |
| `PORT` | No | Not needed for Vercel (serverless) |
| `NODE_ENV` | No | Set to `production` |

## Support

If you encounter issues:
1. Check Vercel deployment logs
2. Check browser console for errors
3. Verify all environment variables are set
4. Ensure GitHub OAuth callback URL matches exactly

